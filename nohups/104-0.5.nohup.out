training on data/WSJ for 5 epochs
parameters: batch size = 50, alpha = 0.05, lambda = 0.5.
initializing word embeddings from 
NB Adagrad ON now
Start part of experiment 104
Loading treebank.
/home/sveldhoen/.local/lib/python2.7/site-packages/numpy/core/fromnumeric.py:2507: VisibleDeprecationWarning: `rank` is deprecated; use the `ndim` attribute or function instead. To find the rank of a matrix see `numpy.linalg.matrix_rank`.
  VisibleDeprecationWarning)
Loading vocabulary.
Grammar-based parameter selection on. Initializing 400 most frequent grammar rules.
Initializing networks.
Loaded data. 22923 training examples, and 6010 test examples.
Initializing theta.
inside - 5
nwords - 10689
word - 5
outside - 5
bSize - 50
alpha - 0.05
lambda - 0.5
nEpochs - 5
number of cores - 5
Start training...
Start SGD training
Epoch 0
evaluating...
	Batch 0 , average error: 1.00001286067 , theta norm: 0.270093227615
	Batch 10 , average error: 0.440138665168 , theta norm: 0.570784441742
	Batch 20 , average error: 0.397060224511 , theta norm: 0.715062440703
	Batch 30 , average error: 0.329372231646 , theta norm: 0.751190972437
	Batch 40 , average error: 0.341997774054 , theta norm: 0.77834157472
	Batch 50 , average error: 0.337964992467 , theta norm: 0.799149230486
	Batch 60 , average error: 0.322661381373 , theta norm: 0.819021881881
	Batch 70 , average error: 0.306605372559 , theta norm: 0.842041341352
	Batch 80 , average error: 0.352772295273 , theta norm: 0.851056562183
	Batch 90 , average error: 0.348636583818 , theta norm: 0.862662556548
	Batch 100 , average error: 0.318192773871 , theta norm: 0.877763889161
	Batch 110 , average error: 0.345280894505 , theta norm: 0.884305859986
	Batch 120 , average error: 0.328516823613 , theta norm: 0.894645344032
	Batch 130 , average error: 0.340718473115 , theta norm: 0.900389701714
	Batch 140 , average error: 0.308995344152 , theta norm: 0.909491204471
	Batch 150 , average error: 0.332705749079 , theta norm: 0.915802625903
	Batch 160 , average error: 0.346942297917 , theta norm: 0.920995995534
	Batch 170 , average error: 0.317393520917 , theta norm: 0.927218230934
	Batch 180 , average error: 0.332062224359 , theta norm: 0.935147047266
	Batch 190 , average error: 0.316799545216 , theta norm: 0.93709974578
	Batch 200 , average error: 0.3110516794 , theta norm: 0.943243577371
	Batch 210 , average error: 0.351005205782 , theta norm: 0.954929523944
	Batch 220 , average error: 0.338326111529 , theta norm: 0.96236221454
	Batch 230 , average error: 0.329276312883 , theta norm: 0.966603392709
	Batch 240 , average error: 0.335106941118 , theta norm: 0.974469879483
	Batch 250 , average error: 0.372660440093 , theta norm: 0.984104498896
	Batch 260 , average error: 0.314771540489 , theta norm: 0.990123920431
	Batch 270 , average error: 0.322773904621 , theta norm: 0.996397992005
	Batch 280 , average error: 0.293110922346 , theta norm: 1.0063393318
	Batch 290 , average error: 0.339514943238 , theta norm: 1.01349710815
	Batch 300 , average error: 0.349573649097 , theta norm: 1.02191837989
	Batch 310 , average error: 0.327245059177 , theta norm: 1.02772806619
	Batch 320 , average error: 0.314386383708 , theta norm: 1.0341987772
	Batch 330 , average error: 0.298477379464 , theta norm: 1.04125125748
	Batch 340 , average error: 0.316551703978 , theta norm: 1.04964229591
	Batch 350 , average error: 0.332381342431 , theta norm: 1.05374024097
	Batch 360 , average error: 0.322308899739 , theta norm: 1.05984748339
	Batch 370 , average error: 0.31619923565 , theta norm: 1.06641091
	Batch 380 , average error: 0.317555108948 , theta norm: 1.06899647099
	Batch 390 , average error: 0.307917962737 , theta norm: 1.07340262701
	Batch 400 , average error: 0.316608283056 , theta norm: 1.07963999274
	Batch 410 , average error: 0.312944531234 , theta norm: 1.08574836252
	Batch 420 , average error: 0.318977106532 , theta norm: 1.08943003428
	Batch 430 , average error: 0.30086368167 , theta norm: 1.0961238298
	Batch 440 , average error: 0.330016219814 , theta norm: 1.10392129418
	Batch 450 , average error: 0.337659555549 , theta norm: 1.10629562653
Epoch 1
evaluating...
	Batch 0 , average error: 0.328682385957 , theta norm: 1.10950248984
	Batch 10 , average error: 0.325402919522 , theta norm: 1.11603893184
	Batch 20 , average error: 0.315366918064 , theta norm: 1.12125374581
	Batch 30 , average error: 0.333507322533 , theta norm: 1.12615404946
	Batch 40 , average error: 0.339805438553 , theta norm: 1.13299253065
	Batch 50 , average error: 0.31886928804 , theta norm: 1.13843764348
	Batch 60 , average error: 0.306914387046 , theta norm: 1.1444123721
	Batch 70 , average error: 0.322224292906 , theta norm: 1.15125317897
	Batch 80 , average error: 0.338091823274 , theta norm: 1.15687063182
	Batch 90 , average error: 0.309607558978 , theta norm: 1.15971863704
	Batch 100 , average error: 0.348054508619 , theta norm: 1.16385625344
	Batch 110 , average error: 0.2874516699 , theta norm: 1.16544203272
	Batch 120 , average error: 0.331052074366 , theta norm: 1.16806219744
	Batch 130 , average error: 0.310737733154 , theta norm: 1.17425123366
	Batch 140 , average error: 0.322644692625 , theta norm: 1.17749757485
	Batch 150 , average error: 0.340819819134 , theta norm: 1.18099776271
	Batch 160 , average error: 0.318344536243 , theta norm: 1.18336118014
	Batch 170 , average error: 0.318868390254 , theta norm: 1.18856723137
	Batch 180 , average error: 0.325032606754 , theta norm: 1.19015201738
	Batch 190 , average error: 0.325883777704 , theta norm: 1.19440557494
	Batch 200 , average error: 0.315114563572 , theta norm: 1.19876901984
	Batch 210 , average error: 0.316055890105 , theta norm: 1.20365742865
	Batch 220 , average error: 0.322380410688 , theta norm: 1.20526431464
	Batch 230 , average error: 0.319163381321 , theta norm: 1.20867395949
	Batch 240 , average error: 0.331586650255 , theta norm: 1.21505496784
	Batch 250 , average error: 0.289316387334 , theta norm: 1.21780253391
	Batch 260 , average error: 0.352061631549 , theta norm: 1.22280017604
	Batch 270 , average error: 0.356267927808 , theta norm: 1.22483355745
	Batch 280 , average error: 0.324825139312 , theta norm: 1.22701665529
	Batch 290 , average error: 0.337108681729 , theta norm: 1.23178243164
	Batch 300 , average error: 0.323591143372 , theta norm: 1.23554607505
	Batch 310 , average error: 0.323656093342 , theta norm: 1.23951194443
	Batch 320 , average error: 0.293066484405 , theta norm: 1.24131909518
	Batch 330 , average error: 0.301279319468 , theta norm: 1.24144224175
	Batch 340 , average error: 0.321173104834 , theta norm: 1.24525503554
	Batch 350 , average error: 0.309195372428 , theta norm: 1.24907990956
	Batch 360 , average error: 0.297208710138 , theta norm: 1.25521335269
	Batch 370 , average error: 0.306378582012 , theta norm: 1.25638014408
	Batch 380 , average error: 0.309702831878 , theta norm: 1.25907592434
	Batch 390 , average error: 0.323216602833 , theta norm: 1.26109676629
	Batch 400 , average error: 0.31502779116 , theta norm: 1.26410633513
	Batch 410 , average error: 0.314980539005 , theta norm: 1.2672373216
	Batch 420 , average error: 0.304435366182 , theta norm: 1.26895446641
	Batch 430 , average error: 0.296066237652 , theta norm: 1.27114002743
	Batch 440 , average error: 0.331208994381 , theta norm: 1.27317720863
	Batch 450 , average error: 0.297563665214 , theta norm: 1.27626613653
Epoch 2
evaluating...
	Batch 0 , average error: 0.302256009678 , theta norm: 1.27844323063
	Batch 10 , average error: 0.30068066662 , theta norm: 1.28056114119
	Batch 20 , average error: 0.325915144262 , theta norm: 1.28526882631
	Batch 30 , average error: 0.293575260408 , theta norm: 1.28796021247
	Batch 40 , average error: 0.281831775053 , theta norm: 1.29042929275
	Batch 50 , average error: 0.311570880221 , theta norm: 1.29187262671
	Batch 60 , average error: 0.282830576985 , theta norm: 1.29358313505
	Batch 70 , average error: 0.322187521849 , theta norm: 1.29496805634
	Batch 80 , average error: 0.326725164563 , theta norm: 1.29722003868
	Batch 90 , average error: 0.297073994242 , theta norm: 1.29771048084
	Batch 100 , average error: 0.323398474318 , theta norm: 1.29895044763
	Batch 110 , average error: 0.304402150931 , theta norm: 1.30216503273
	Batch 120 , average error: 0.285686602021 , theta norm: 1.30440016895
	Batch 130 , average error: 0.304440280866 , theta norm: 1.309162852
	Batch 140 , average error: 0.291317477902 , theta norm: 1.31311393747
	Batch 150 , average error: 0.302184886886 , theta norm: 1.31647554063
	Batch 160 , average error: 0.319680382636 , theta norm: 1.31802506942
	Batch 170 , average error: 0.293808264444 , theta norm: 1.32241809921
	Batch 180 , average error: 0.293651765691 , theta norm: 1.3242193691
	Batch 190 , average error: 0.30830657338 , theta norm: 1.32657452385
	Batch 200 , average error: 0.299326047033 , theta norm: 1.32895798423
	Batch 210 , average error: 0.320648090423 , theta norm: 1.32955971788
	Batch 220 , average error: 0.343469592366 , theta norm: 1.3320994437
	Batch 230 , average error: 0.31275058605 , theta norm: 1.33382321774
	Batch 240 , average error: 0.317758567557 , theta norm: 1.33480489509
	Batch 250 , average error: 0.310682984905 , theta norm: 1.33660192418
	Batch 260 , average error: 0.32861741914 , theta norm: 1.33909706071
	Batch 270 , average error: 0.308158761927 , theta norm: 1.34138683843
	Batch 280 , average error: 0.30840404621 , theta norm: 1.34505836222
	Batch 290 , average error: 0.31830612567 , theta norm: 1.34859139678
	Batch 300 , average error: 0.333473116039 , theta norm: 1.35163481231
	Batch 310 , average error: 0.315097759609 , theta norm: 1.35353907104
	Batch 320 , average error: 0.28517208481 , theta norm: 1.35654802327
	Batch 330 , average error: 0.287415224688 , theta norm: 1.35834825703
	Batch 340 , average error: 0.309538635151 , theta norm: 1.36038785522
	Batch 350 , average error: 0.319184896479 , theta norm: 1.3634989964
	Batch 360 , average error: 0.298443435922 , theta norm: 1.36562915155
	Batch 370 , average error: 0.319818369403 , theta norm: 1.36659473161
	Batch 380 , average error: 0.314693758634 , theta norm: 1.3700216752
	Batch 390 , average error: 0.309483682558 , theta norm: 1.36991287868
	Batch 400 , average error: 0.30543658349 , theta norm: 1.37125758802
	Batch 410 , average error: 0.307666945342 , theta norm: 1.37339643947
	Batch 420 , average error: 0.284701695186 , theta norm: 1.374239805
	Batch 430 , average error: 0.330065438622 , theta norm: 1.37735167939
	Batch 440 , average error: 0.315414561287 , theta norm: 1.38046938339
	Batch 450 , average error: 0.29775125784 , theta norm: 1.38132743678
Epoch 3
evaluating...
	Batch 0 , average error: 0.297192442245 , theta norm: 1.38294510425
	Batch 10 , average error: 0.306937323221 , theta norm: 1.38588533473
	Batch 20 , average error: 0.308425640342 , theta norm: 1.38743466331
	Batch 30 , average error: 0.305992829846 , theta norm: 1.38995682191
	Batch 40 , average error: 0.333825240981 , theta norm: 1.39371314458
	Batch 50 , average error: 0.318585666828 , theta norm: 1.39594957705
	Batch 60 , average error: 0.295449701063 , theta norm: 1.39721770302
	Batch 70 , average error: 0.292263074603 , theta norm: 1.39830333629
	Batch 80 , average error: 0.297771472174 , theta norm: 1.39908878824
	Batch 90 , average error: 0.318875238148 , theta norm: 1.3999232326
	Batch 100 , average error: 0.264886040158 , theta norm: 1.40260675721
	Batch 110 , average error: 0.308746349497 , theta norm: 1.40520356929
	Batch 120 , average error: 0.320440659807 , theta norm: 1.40701945468
	Batch 130 , average error: 0.279616134595 , theta norm: 1.40964505228
	Batch 140 , average error: 0.304452079726 , theta norm: 1.41059192388
	Batch 150 , average error: 0.296796913022 , theta norm: 1.412383299
	Batch 160 , average error: 0.299040567027 , theta norm: 1.41456730005
	Batch 170 , average error: 0.279529786152 , theta norm: 1.41559170988
	Batch 180 , average error: 0.299320051405 , theta norm: 1.41670379799
	Batch 190 , average error: 0.315923317718 , theta norm: 1.41751775618
	Batch 200 , average error: 0.303462381933 , theta norm: 1.41961432125
	Batch 210 , average error: 0.289739525187 , theta norm: 1.42359608404
	Batch 220 , average error: 0.307502629509 , theta norm: 1.42530119248
	Batch 230 , average error: 0.321107776736 , theta norm: 1.42607908649
	Batch 240 , average error: 0.298081761499 , theta norm: 1.42837700353
	Batch 250 , average error: 0.307879002892 , theta norm: 1.43061668989
	Batch 260 , average error: 0.31003230825 , theta norm: 1.4318406068
	Batch 270 , average error: 0.317038427021 , theta norm: 1.43345796054
	Batch 280 , average error: 0.290417566942 , theta norm: 1.43528331907
	Batch 290 , average error: 0.312709555712 , theta norm: 1.43660919125
	Batch 300 , average error: 0.279406382576 , theta norm: 1.43848485032
	Batch 310 , average error: 0.276583411058 , theta norm: 1.44036959074
	Batch 320 , average error: 0.306827729305 , theta norm: 1.44333190969
	Batch 330 , average error: 0.313747839882 , theta norm: 1.44469036173
	Batch 340 , average error: 0.308360527671 , theta norm: 1.44696440652
	Batch 350 , average error: 0.318742698267 , theta norm: 1.44926537801
	Batch 360 , average error: 0.263079133476 , theta norm: 1.45133296712
	Batch 370 , average error: 0.298641523655 , theta norm: 1.45240277372
	Batch 380 , average error: 0.318973142795 , theta norm: 1.45515653772
	Batch 390 , average error: 0.300197414912 , theta norm: 1.45731067426
	Batch 400 , average error: 0.284068488206 , theta norm: 1.45991560015
	Batch 410 , average error: 0.275666297799 , theta norm: 1.4616854947
	Batch 420 , average error: 0.31354313053 , theta norm: 1.46347280186
	Batch 430 , average error: 0.292934328535 , theta norm: 1.46401903546
	Batch 440 , average error: 0.289318546715 , theta norm: 1.46640178175
	Batch 450 , average error: 0.328599862006 , theta norm: 1.4684092373
Epoch 4
evaluating...
	Batch 0 , average error: 0.285814515015 , theta norm: 1.46964919514
	Batch 10 , average error: 0.28721494587 , theta norm: 1.47165487186
	Batch 20 , average error: 0.284391650684 , theta norm: 1.47335110948
	Batch 30 , average error: 0.284060375479 , theta norm: 1.47553502821
	Batch 40 , average error: 0.317108050564 , theta norm: 1.47722049697
	Batch 50 , average error: 0.320209470161 , theta norm: 1.4784554629
	Batch 60 , average error: 0.316612211368 , theta norm: 1.4794180159
	Batch 70 , average error: 0.31593714515 , theta norm: 1.48070182946
	Batch 80 , average error: 0.286342622574 , theta norm: 1.4821262104
	Batch 90 , average error: 0.277188414733 , theta norm: 1.48383589943
	Batch 100 , average error: 0.314154864843 , theta norm: 1.48521091763
	Batch 110 , average error: 0.282909369792 , theta norm: 1.48709363337
	Batch 120 , average error: 0.305432216314 , theta norm: 1.4890755988
	Batch 130 , average error: 0.265111004121 , theta norm: 1.49102601127
	Batch 140 , average error: 0.32393697235 , theta norm: 1.4925560937
	Batch 150 , average error: 0.2715422759 , theta norm: 1.49446512624
	Batch 160 , average error: 0.339590141083 , theta norm: 1.49648167168
	Batch 170 , average error: 0.318601089259 , theta norm: 1.49796923235
	Batch 180 , average error: 0.341685791614 , theta norm: 1.49938766345
	Batch 190 , average error: 0.289843121577 , theta norm: 1.50204996896
	Batch 200 , average error: 0.294489364308 , theta norm: 1.50288161449
	Batch 210 , average error: 0.3176875474 , theta norm: 1.50401447963
	Batch 220 , average error: 0.28617884867 , theta norm: 1.50560143725
	Batch 230 , average error: 0.2907778831 , theta norm: 1.50661865322
	Batch 240 , average error: 0.298405205045 , theta norm: 1.50664416541
	Batch 250 , average error: 0.305649092833 , theta norm: 1.50889437676
	Batch 260 , average error: 0.320336857043 , theta norm: 1.51225758048
	Batch 270 , average error: 0.283948322524 , theta norm: 1.51495835197
	Batch 280 , average error: 0.301229798471 , theta norm: 1.51567892068
	Batch 290 , average error: 0.304209205567 , theta norm: 1.51773790236
	Batch 300 , average error: 0.30815544798 , theta norm: 1.51869141413
	Batch 310 , average error: 0.321595358327 , theta norm: 1.52019118832
	Batch 320 , average error: 0.30999484214 , theta norm: 1.52262192995
	Batch 330 , average error: 0.335846430791 , theta norm: 1.52408586851
	Batch 340 , average error: 0.317162713034 , theta norm: 1.52427557983
	Batch 350 , average error: 0.308514030343 , theta norm: 1.52627210595
	Batch 360 , average error: 0.326536746626 , theta norm: 1.52813394859
	Batch 370 , average error: 0.299889576368 , theta norm: 1.52946829643
	Batch 380 , average error: 0.325853555795 , theta norm: 1.53073853735
	Batch 390 , average error: 0.310542239456 , theta norm: 1.53167478139
	Batch 400 , average error: 0.307054243926 , theta norm: 1.53239209643
	Batch 410 , average error: 0.320264941932 , theta norm: 1.53458900579
	Batch 420 , average error: 0.293379295829 , theta norm: 1.53525378555
	Batch 430 , average error: 0.307493681961 , theta norm: 1.53676347579
	Batch 440 , average error: 0.30270352898 , theta norm: 1.53640116192
	Batch 450 , average error: 0.321817364979 , theta norm: 1.5377449209
evaluating...
Computing performance... 6
Initial Performance on validation set: 0.542388544213
Initial Performance on validation set: 0.542388544213
Epoch 0, Performance on validation set: 0.142851032501
Epoch 0, Performance on validation set: 0.142851032501
Epoch 1, Performance on validation set: 0.142816146365
Epoch 1, Performance on validation set: 0.142816146365
Epoch 2, Performance on validation set: 0.143684342314
Epoch 2, Performance on validation set: 0.143684342314
Epoch 3, Performance on validation set: 0.144137142546
Epoch 3, Performance on validation set: 0.144137142546
Epoch 4, Performance on validation set: 0.1442054786
Epoch 4, Performance on validation set: 0.1442054786
End of training.
Writing model to file.
