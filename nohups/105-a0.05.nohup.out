training on data/WSJ for 5 epochs
initializing word embeddings from 
parameters: batch size = 50, alpha = 0.05, lambda = 0.5.
NB Adagrad ON now
Start part of experiment 105
Loading treebank.
/home/sveldhoen/.local/lib/python2.7/site-packages/numpy/core/fromnumeric.py:2507: VisibleDeprecationWarning: `rank` is deprecated; use the `ndim` attribute or function instead. To find the rank of a matrix see `numpy.linalg.matrix_rank`.
  VisibleDeprecationWarning)
Loading vocabulary.
Grammar-based parameter selection on. Initializing 400 most frequent grammar rules.
Initializing networks.
Loaded data. 22923 training examples, and 6010 test examples.
Initializing theta.
inside - 5
nwords - 10689
word - 5
outside - 5
bSize - 50
alpha - 0.05
lambda - 0.5
nEpochs - 5
number of cores - 5
Start training...
Start SGD training
Epoch 0
evaluating...
	Batch 0 , average error: 1.00003326463 , theta norm: 0.270015032492
	Batch 10 , average error: 0.466723417369 , theta norm: 0.51473635047
	Batch 20 , average error: 0.384842283985 , theta norm: 0.646643236961
	Batch 30 , average error: 0.354564546279 , theta norm: 0.714041683555
	Batch 40 , average error: 0.351480108363 , theta norm: 0.757877476516
	Batch 50 , average error: 0.335487711882 , theta norm: 0.784918611409
	Batch 60 , average error: 0.355211308292 , theta norm: 0.814831849333
	Batch 70 , average error: 0.353219114565 , theta norm: 0.839664956683
	Batch 80 , average error: 0.339302072315 , theta norm: 0.862289400362
	Batch 90 , average error: 0.337800812815 , theta norm: 0.884521371618
	Batch 100 , average error: 0.378047765394 , theta norm: 0.899020520832
	Batch 110 , average error: 0.332805409458 , theta norm: 0.914193414011
	Batch 120 , average error: 0.33826228303 , theta norm: 0.923210032338
	Batch 130 , average error: 0.324404076195 , theta norm: 0.937542318979
	Batch 140 , average error: 0.336275395626 , theta norm: 0.95104096351
	Batch 150 , average error: 0.313376503369 , theta norm: 0.957509557145
	Batch 160 , average error: 0.332615963859 , theta norm: 0.9700166284
	Batch 170 , average error: 0.320999897541 , theta norm: 0.982774178855
	Batch 180 , average error: 0.344967526384 , theta norm: 0.988776507996
	Batch 190 , average error: 0.33504441012 , theta norm: 0.998925324649
	Batch 200 , average error: 0.316931141509 , theta norm: 1.00718032956
	Batch 210 , average error: 0.332357400381 , theta norm: 1.01549956977
	Batch 220 , average error: 0.335664948851 , theta norm: 1.02409099146
	Batch 230 , average error: 0.350129487146 , theta norm: 1.02716996477
	Batch 240 , average error: 0.350219665098 , theta norm: 1.03463879969
	Batch 250 , average error: 0.300740546454 , theta norm: 1.04018243392
	Batch 260 , average error: 0.3031164765 , theta norm: 1.04762411256
	Batch 270 , average error: 0.320442928946 , theta norm: 1.05784903807
	Batch 280 , average error: 0.357831019742 , theta norm: 1.06355698608
	Batch 290 , average error: 0.356263056457 , theta norm: 1.07244380432
	Batch 300 , average error: 0.360068153877 , theta norm: 1.07928351711
	Batch 310 , average error: 0.313673769922 , theta norm: 1.08451082632
	Batch 320 , average error: 0.371041192453 , theta norm: 1.08870904224
	Batch 330 , average error: 0.355678304571 , theta norm: 1.09309259936
	Batch 340 , average error: 0.358489109119 , theta norm: 1.09879592734
	Batch 350 , average error: 0.349334373092 , theta norm: 1.10525352906
	Batch 360 , average error: 0.307223993875 , theta norm: 1.10947093882
	Batch 370 , average error: 0.311972801758 , theta norm: 1.1126955313
	Batch 380 , average error: 0.311309740765 , theta norm: 1.11684625261
	Batch 390 , average error: 0.302308562481 , theta norm: 1.12371120524
	Batch 400 , average error: 0.302825268623 , theta norm: 1.12748307155
	Batch 410 , average error: 0.330688865298 , theta norm: 1.13040122352
	Batch 420 , average error: 0.284498853866 , theta norm: 1.13419893037
	Batch 430 , average error: 0.331582721933 , theta norm: 1.13984228504
	Batch 440 , average error: 0.324906678025 , theta norm: 1.14256141031
	Batch 450 , average error: 0.330592918718 , theta norm: 1.14582648113
Epoch 1
evaluating...
	Batch 0 , average error: 0.322900632911 , theta norm: 1.14858505992
	Batch 10 , average error: 0.343171224417 , theta norm: 1.156046444
	Batch 20 , average error: 0.303840000179 , theta norm: 1.15936146169
	Batch 30 , average error: 0.350547674867 , theta norm: 1.1663355236
	Batch 40 , average error: 0.32085369678 , theta norm: 1.16966785078
	Batch 50 , average error: 0.320840683606 , theta norm: 1.17463390285
	Batch 60 , average error: 0.330879268367 , theta norm: 1.18031867937
	Batch 70 , average error: 0.297505393343 , theta norm: 1.18522369721
	Batch 80 , average error: 0.326773063596 , theta norm: 1.19107161925
	Batch 90 , average error: 0.305655971237 , theta norm: 1.1940179971
	Batch 100 , average error: 0.304998987998 , theta norm: 1.19626321147
	Batch 110 , average error: 0.31328629606 , theta norm: 1.20193805304
	Batch 120 , average error: 0.317083181002 , theta norm: 1.20473063744
	Batch 130 , average error: 0.304076342606 , theta norm: 1.20603232838
	Batch 140 , average error: 0.327392741095 , theta norm: 1.20984085597
	Batch 150 , average error: 0.299337157 , theta norm: 1.21205994886
	Batch 160 , average error: 0.341120533582 , theta norm: 1.21540622894
	Batch 170 , average error: 0.325484919403 , theta norm: 1.21661911099
	Batch 180 , average error: 0.333273574017 , theta norm: 1.21979606478
	Batch 190 , average error: 0.315489022534 , theta norm: 1.22111087244
	Batch 200 , average error: 0.340244930687 , theta norm: 1.22351439966
	Batch 210 , average error: 0.314411823308 , theta norm: 1.22401548052
	Batch 220 , average error: 0.322875594937 , theta norm: 1.22670642686
	Batch 230 , average error: 0.300395926584 , theta norm: 1.22763473749
	Batch 240 , average error: 0.296266460684 , theta norm: 1.22933430178
	Batch 250 , average error: 0.321113513785 , theta norm: 1.23242528934
	Batch 260 , average error: 0.306617255978 , theta norm: 1.23473066581
	Batch 270 , average error: 0.320870445568 , theta norm: 1.23534010453
	Batch 280 , average error: 0.284940635636 , theta norm: 1.2355397997
	Batch 290 , average error: 0.326408262148 , theta norm: 1.23589456335
	Batch 300 , average error: 0.310307106978 , theta norm: 1.23694484661
	Batch 310 , average error: 0.314486755237 , theta norm: 1.23854759073
	Batch 320 , average error: 0.311465053004 , theta norm: 1.24184008538
	Batch 330 , average error: 0.305055146781 , theta norm: 1.24422542153
	Batch 340 , average error: 0.342083540742 , theta norm: 1.24495407682
	Batch 350 , average error: 0.332471213834 , theta norm: 1.24805622086
	Batch 360 , average error: 0.321085246135 , theta norm: 1.24979972988
	Batch 370 , average error: 0.309607587958 , theta norm: 1.25297845165
	Batch 380 , average error: 0.355109334944 , theta norm: 1.25711999641
	Batch 390 , average error: 0.341964294075 , theta norm: 1.26025395463
	Batch 400 , average error: 0.307690473724 , theta norm: 1.26032771762
	Batch 410 , average error: 0.313059917593 , theta norm: 1.26185465604
	Batch 420 , average error: 0.309706298772 , theta norm: 1.26589860863
	Batch 430 , average error: 0.314018515526 , theta norm: 1.26774135398
	Batch 440 , average error: 0.29402231822 , theta norm: 1.27107587329
	Batch 450 , average error: 0.327061014282 , theta norm: 1.27734514993
Epoch 2
evaluating...
	Batch 0 , average error: 0.336041560242 , theta norm: 1.2790573739
	Batch 10 , average error: 0.310809557131 , theta norm: 1.28186619721
	Batch 20 , average error: 0.332550859972 , theta norm: 1.28375539393
	Batch 30 , average error: 0.331665153684 , theta norm: 1.28540478593
	Batch 40 , average error: 0.313371820214 , theta norm: 1.287554262
	Batch 50 , average error: 0.318529514413 , theta norm: 1.28935505626
	Batch 60 , average error: 0.32478747389 , theta norm: 1.29172336887
	Batch 70 , average error: 0.324658125708 , theta norm: 1.29443252929
	Batch 80 , average error: 0.325140508036 , theta norm: 1.29618213609
	Batch 90 , average error: 0.303338062682 , theta norm: 1.29817402089
	Batch 100 , average error: 0.345464312738 , theta norm: 1.29974486644
	Batch 110 , average error: 0.289142034113 , theta norm: 1.30261814878
	Batch 120 , average error: 0.320716056604 , theta norm: 1.30229142775
	Batch 130 , average error: 0.292930859206 , theta norm: 1.30546807243
	Batch 140 , average error: 0.340783667611 , theta norm: 1.3076769744
	Batch 150 , average error: 0.311545604379 , theta norm: 1.3093557445
	Batch 160 , average error: 0.301653392964 , theta norm: 1.30906896133
	Batch 170 , average error: 0.287416622046 , theta norm: 1.31183594533
	Batch 180 , average error: 0.335273587732 , theta norm: 1.31409562457
	Batch 190 , average error: 0.335892132275 , theta norm: 1.31855526127
	Batch 200 , average error: 0.278447442977 , theta norm: 1.32212906761
	Batch 210 , average error: 0.287054640693 , theta norm: 1.3223901955
	Batch 220 , average error: 0.340828059986 , theta norm: 1.32354082736
	Batch 230 , average error: 0.323484635674 , theta norm: 1.32334563627
	Batch 240 , average error: 0.301432205802 , theta norm: 1.32494522014
	Batch 250 , average error: 0.30641645541 , theta norm: 1.32723763495
	Batch 260 , average error: 0.31525819178 , theta norm: 1.32820504821
	Batch 270 , average error: 0.339833063353 , theta norm: 1.33031922372
	Batch 280 , average error: 0.331716494821 , theta norm: 1.33216452586
	Batch 290 , average error: 0.31201229582 , theta norm: 1.33531600576
	Batch 300 , average error: 0.322354303273 , theta norm: 1.33691593719
	Batch 310 , average error: 0.351973286861 , theta norm: 1.34002737084
	Batch 320 , average error: 0.306205596421 , theta norm: 1.3409061168
	Batch 330 , average error: 0.283942089452 , theta norm: 1.34267292589
	Batch 340 , average error: 0.325867627822 , theta norm: 1.34307943016
	Batch 350 , average error: 0.305876422964 , theta norm: 1.3451023891
	Batch 360 , average error: 0.312943044694 , theta norm: 1.34678619479
	Batch 370 , average error: 0.312963856331 , theta norm: 1.34885150363
	Batch 380 , average error: 0.281112957367 , theta norm: 1.3517985219
	Batch 390 , average error: 0.298190386258 , theta norm: 1.35231185522
	Batch 400 , average error: 0.305307969501 , theta norm: 1.35462439034
	Batch 410 , average error: 0.320346750604 , theta norm: 1.35715942171
	Batch 420 , average error: 0.320547416127 , theta norm: 1.35847776785
	Batch 430 , average error: 0.302298756236 , theta norm: 1.35979072071
	Batch 440 , average error: 0.319017747013 , theta norm: 1.3606479869
	Batch 450 , average error: 0.309317697592 , theta norm: 1.3630304473
Epoch 3
evaluating...
	Batch 0 , average error: 0.295457444656 , theta norm: 1.36449335838
	Batch 10 , average error: 0.289774839226 , theta norm: 1.36714435773
	Batch 20 , average error: 0.328039790327 , theta norm: 1.36926714883
	Batch 30 , average error: 0.317573179942 , theta norm: 1.37063312582
	Batch 40 , average error: 0.30364685547 , theta norm: 1.3722150261
	Batch 50 , average error: 0.325600150785 , theta norm: 1.37287687293
	Batch 60 , average error: 0.318075972177 , theta norm: 1.3741335644
	Batch 70 , average error: 0.326631381122 , theta norm: 1.37462858284
	Batch 80 , average error: 0.295871080839 , theta norm: 1.37553412065
	Batch 90 , average error: 0.294929534478 , theta norm: 1.37703046108
	Batch 100 , average error: 0.285197464151 , theta norm: 1.37886370191
	Batch 110 , average error: 0.317713229547 , theta norm: 1.38030386276
	Batch 120 , average error: 0.343114277342 , theta norm: 1.38181999712
	Batch 130 , average error: 0.315201171875 , theta norm: 1.38231005463
	Batch 140 , average error: 0.289511939024 , theta norm: 1.38391593994
	Batch 150 , average error: 0.332343759145 , theta norm: 1.38530534185
	Batch 160 , average error: 0.294925266021 , theta norm: 1.38580836698
	Batch 170 , average error: 0.317444577083 , theta norm: 1.38670907076
	Batch 180 , average error: 0.305237813579 , theta norm: 1.38817678593
	Batch 190 , average error: 0.317693626508 , theta norm: 1.38947317616
	Batch 200 , average error: 0.286013635878 , theta norm: 1.39070496783
	Batch 210 , average error: 0.27048874949 , theta norm: 1.3927418109
	Batch 220 , average error: 0.30649418342 , theta norm: 1.39305636813
	Batch 230 , average error: 0.288184750033 , theta norm: 1.39362010943
	Batch 240 , average error: 0.280694739206 , theta norm: 1.39456838591
	Batch 250 , average error: 0.310244846161 , theta norm: 1.39515790742
	Batch 260 , average error: 0.310133412446 , theta norm: 1.39725527529
	Batch 270 , average error: 0.310891281119 , theta norm: 1.39818298084
	Batch 280 , average error: 0.317711054507 , theta norm: 1.40053636418
	Batch 290 , average error: 0.306385266288 , theta norm: 1.40298239156
	Batch 300 , average error: 0.324054684598 , theta norm: 1.40392578955
	Batch 310 , average error: 0.319014534117 , theta norm: 1.40514093245
	Batch 320 , average error: 0.268246994005 , theta norm: 1.40683025054
	Batch 330 , average error: 0.308482091266 , theta norm: 1.40745841587
	Batch 340 , average error: 0.297096918696 , theta norm: 1.40773431697
	Batch 350 , average error: 0.320714255692 , theta norm: 1.40937816621
	Batch 360 , average error: 0.30154716001 , theta norm: 1.40951592976
	Batch 370 , average error: 0.297933107246 , theta norm: 1.40934421738
	Batch 380 , average error: 0.329454609453 , theta norm: 1.41148391689
	Batch 390 , average error: 0.313915492163 , theta norm: 1.41367547329
	Batch 400 , average error: 0.322353814451 , theta norm: 1.41530331012
	Batch 410 , average error: 0.318283338391 , theta norm: 1.4163640544
	Batch 420 , average error: 0.284855364989 , theta norm: 1.41827944764
	Batch 430 , average error: 0.295658121119 , theta norm: 1.42079027997
	Batch 440 , average error: 0.292878554454 , theta norm: 1.42255512635
	Batch 450 , average error: 0.312260472324 , theta norm: 1.42386994053
Epoch 4
evaluating...
	Batch 0 , average error: 0.302958823489 , theta norm: 1.42407520072
	Batch 10 , average error: 0.343904764905 , theta norm: 1.4256594222
	Batch 20 , average error: 0.290649535899 , theta norm: 1.42721390423
	Batch 30 , average error: 0.33489828451 , theta norm: 1.42869095101
	Batch 40 , average error: 0.301172797486 , theta norm: 1.43082821612
	Batch 50 , average error: 0.296950490126 , theta norm: 1.43298882283
	Batch 60 , average error: 0.302415145889 , theta norm: 1.43332508993
	Batch 70 , average error: 0.283533606524 , theta norm: 1.43435057741
	Batch 80 , average error: 0.313999872908 , theta norm: 1.43465772027
	Batch 90 , average error: 0.284362957773 , theta norm: 1.43682620215
	Batch 100 , average error: 0.286819186062 , theta norm: 1.43800411872
	Batch 110 , average error: 0.298325938867 , theta norm: 1.43864515142
	Batch 120 , average error: 0.304238160301 , theta norm: 1.43845136079
	Batch 130 , average error: 0.302023569785 , theta norm: 1.44020581757
	Batch 140 , average error: 0.272543906692 , theta norm: 1.44246480434
	Batch 150 , average error: 0.316227269685 , theta norm: 1.44375827566
	Batch 160 , average error: 0.286240746805 , theta norm: 1.44444153628
	Batch 170 , average error: 0.280659344944 , theta norm: 1.44426836352
	Batch 180 , average error: 0.340599795482 , theta norm: 1.44554780465
	Batch 190 , average error: 0.327541584431 , theta norm: 1.44608524994
	Batch 200 , average error: 0.319511137809 , theta norm: 1.44636129448
	Batch 210 , average error: 0.3119032396 , theta norm: 1.44722249933
	Batch 220 , average error: 0.311332838666 , theta norm: 1.44821945249
	Batch 230 , average error: 0.32151443076 , theta norm: 1.44801982054
	Batch 240 , average error: 0.32006961077 , theta norm: 1.44801137363
	Batch 250 , average error: 0.298720359747 , theta norm: 1.44994645232
	Batch 260 , average error: 0.312683407685 , theta norm: 1.45007673907
	Batch 270 , average error: 0.320040637668 , theta norm: 1.45169942008
	Batch 280 , average error: 0.310015184081 , theta norm: 1.45393460034
	Batch 290 , average error: 0.288307795259 , theta norm: 1.45411681541
	Batch 300 , average error: 0.270042220158 , theta norm: 1.45551021106
	Batch 310 , average error: 0.297888734057 , theta norm: 1.45668374849
	Batch 320 , average error: 0.323617646945 , theta norm: 1.45849349956
	Batch 330 , average error: 0.278943940656 , theta norm: 1.4597204692
	Batch 340 , average error: 0.310312525543 , theta norm: 1.46153006691
	Batch 350 , average error: 0.288722794372 , theta norm: 1.46265257404
	Batch 360 , average error: 0.304935811269 , theta norm: 1.4650968048
	Batch 370 , average error: 0.312504261341 , theta norm: 1.46657029323
	Batch 380 , average error: 0.313350023593 , theta norm: 1.46796386491
	Batch 390 , average error: 0.296906329635 , theta norm: 1.46853709714
	Batch 400 , average error: 0.297108278312 , theta norm: 1.46956835181
	Batch 410 , average error: 0.320383537105 , theta norm: 1.46983345998
	Batch 420 , average error: 0.299182873685 , theta norm: 1.47165219297
	Batch 430 , average error: 0.287508068961 , theta norm: 1.4722470677
	Batch 440 , average error: 0.310714414036 , theta norm: 1.47322695672
	Batch 450 , average error: 0.305450244924 , theta norm: 1.47473997002
Computing performance... 6
evaluating...
Initial Performance on validation set: 0.521103327022
Initial Performance on validation set: 0.521103327022
Epoch 0, Performance on validation set: 0.143148087179
Epoch 0, Performance on validation set: 0.143148087179
Epoch 1, Performance on validation set: 0.14485614587
Epoch 1, Performance on validation set: 0.14485614587
Epoch 2, Performance on validation set: 0.145267104439
Epoch 2, Performance on validation set: 0.145267104439
Epoch 3, Performance on validation set: 0.145519088103
Epoch 3, Performance on validation set: 0.145519088103
Epoch 4, Performance on validation set: 0.145837837401
Epoch 4, Performance on validation set: 0.145837837401
End of training.
Writing model to file.
