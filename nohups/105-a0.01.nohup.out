training on data/WSJ for 5 epochs
NB Adagrad ON now
parameters: batch size = 50, alpha = 0.01, lambda = 0.5.
initializing word embeddings from 
Start part of experiment 105
Loading treebank.
/home/sveldhoen/.local/lib/python2.7/site-packages/numpy/core/fromnumeric.py:2507: VisibleDeprecationWarning: `rank` is deprecated; use the `ndim` attribute or function instead. To find the rank of a matrix see `numpy.linalg.matrix_rank`.
  VisibleDeprecationWarning)
Loading vocabulary.
Grammar-based parameter selection on. Initializing 400 most frequent grammar rules.
Initializing networks.
Loaded data. 22923 training examples, and 6010 test examples.
Initializing theta.
inside - 5
nwords - 10689
word - 5
outside - 5
bSize - 50
alpha - 0.01
lambda - 0.5
nEpochs - 5
number of cores - 5
Start training...
Start SGD training
Epoch 0
evaluating...
	Batch 0 , average error: 0.99998089272 , theta norm: 0.270353317286
	Batch 10 , average error: 0.905655079417 , theta norm: 0.290315475483
	Batch 20 , average error: 0.572303979589 , theta norm: 0.336081592084
	Batch 30 , average error: 0.43338228785 , theta norm: 0.383825624318
	Batch 40 , average error: 0.39433457718 , theta norm: 0.422387777988
	Batch 50 , average error: 0.360940432326 , theta norm: 0.444863214308
	Batch 60 , average error: 0.369123440804 , theta norm: 0.458081172088
	Batch 70 , average error: 0.352837642928 , theta norm: 0.466353989084
	Batch 80 , average error: 0.347269929759 , theta norm: 0.474711406425
	Batch 90 , average error: 0.342688578714 , theta norm: 0.478671434048
	Batch 100 , average error: 0.303733476493 , theta norm: 0.482294282765
	Batch 110 , average error: 0.315499877956 , theta norm: 0.486738392766
	Batch 120 , average error: 0.323644319872 , theta norm: 0.489367992251
	Batch 130 , average error: 0.320029804045 , theta norm: 0.495419587333
	Batch 140 , average error: 0.298241688596 , theta norm: 0.497337025441
	Batch 150 , average error: 0.32323691047 , theta norm: 0.500979249138
	Batch 160 , average error: 0.304888947419 , theta norm: 0.504212081585
	Batch 170 , average error: 0.337053277858 , theta norm: 0.506875533521
	Batch 180 , average error: 0.336734856665 , theta norm: 0.509718514042
	Batch 190 , average error: 0.316558383302 , theta norm: 0.511981074633
	Batch 200 , average error: 0.329252749498 , theta norm: 0.513903828727
	Batch 210 , average error: 0.316874380146 , theta norm: 0.513783656176
	Batch 220 , average error: 0.326871329128 , theta norm: 0.513653558421
	Batch 230 , average error: 0.319098904405 , theta norm: 0.517245574397
	Batch 240 , average error: 0.318657062816 , theta norm: 0.521296391248
	Batch 250 , average error: 0.287709575804 , theta norm: 0.523653013576
	Batch 260 , average error: 0.298744994978 , theta norm: 0.526321826632
	Batch 270 , average error: 0.322952424425 , theta norm: 0.528707179283
	Batch 280 , average error: 0.326779583989 , theta norm: 0.532867835085
	Batch 290 , average error: 0.293975849619 , theta norm: 0.535308523842
	Batch 300 , average error: 0.331511010041 , theta norm: 0.537748748428
	Batch 310 , average error: 0.287428428915 , theta norm: 0.539554067253
	Batch 320 , average error: 0.310794668685 , theta norm: 0.541768023187
	Batch 330 , average error: 0.287230817607 , theta norm: 0.54446763692
	Batch 340 , average error: 0.31684366281 , theta norm: 0.550739225272
	Batch 350 , average error: 0.305645240021 , theta norm: 0.552777824914
	Batch 360 , average error: 0.307825054864 , theta norm: 0.554632884101
	Batch 370 , average error: 0.352570340712 , theta norm: 0.560195789811
	Batch 380 , average error: 0.307588223367 , theta norm: 0.563650880813
	Batch 390 , average error: 0.306544783481 , theta norm: 0.566475736833
	Batch 400 , average error: 0.31114583862 , theta norm: 0.568063729426
	Batch 410 , average error: 0.326245346382 , theta norm: 0.571687824018
	Batch 420 , average error: 0.290810534914 , theta norm: 0.571223026697
	Batch 430 , average error: 0.287917532062 , theta norm: 0.573233866022
	Batch 440 , average error: 0.326392694077 , theta norm: 0.573898397078
	Batch 450 , average error: 0.308371682632 , theta norm: 0.574443613811
Epoch 1
evaluating...
	Batch 0 , average error: 0.319023712766 , theta norm: 0.580058304772
	Batch 10 , average error: 0.292948480362 , theta norm: 0.581153646091
	Batch 20 , average error: 0.306803433635 , theta norm: 0.580511049066
	Batch 30 , average error: 0.302899791386 , theta norm: 0.582926892248
	Batch 40 , average error: 0.308698056852 , theta norm: 0.58440561771
	Batch 50 , average error: 0.296107970487 , theta norm: 0.58777749186
	Batch 60 , average error: 0.294257908408 , theta norm: 0.59105874091
	Batch 70 , average error: 0.321943847112 , theta norm: 0.591781642097
	Batch 80 , average error: 0.291883927128 , theta norm: 0.590725250541
	Batch 90 , average error: 0.310846080056 , theta norm: 0.595055641045
	Batch 100 , average error: 0.298935944418 , theta norm: 0.597937868295
	Batch 110 , average error: 0.314441505115 , theta norm: 0.598762952759
	Batch 120 , average error: 0.296846507309 , theta norm: 0.607038511125
	Batch 130 , average error: 0.275404671687 , theta norm: 0.611374787728
	Batch 140 , average error: 0.296667566042 , theta norm: 0.614770641179
	Batch 150 , average error: 0.319018043364 , theta norm: 0.619139373907
	Batch 160 , average error: 0.307068210518 , theta norm: 0.623411600858
	Batch 170 , average error: 0.285260516752 , theta norm: 0.629420563711
	Batch 180 , average error: 0.267140203294 , theta norm: 0.630234274125
	Batch 190 , average error: 0.277606094743 , theta norm: 0.629532461312
	Batch 200 , average error: 0.338081016714 , theta norm: 0.628146860396
	Batch 210 , average error: 0.291318628087 , theta norm: 0.630347259558
	Batch 220 , average error: 0.295389044861 , theta norm: 0.635466188054
	Batch 230 , average error: 0.305252158158 , theta norm: 0.636754370384
	Batch 240 , average error: 0.308546286112 , theta norm: 0.636686973698
	Batch 250 , average error: 0.307400030855 , theta norm: 0.637366597709
	Batch 260 , average error: 0.301335975551 , theta norm: 0.640744776652
	Batch 270 , average error: 0.298485107624 , theta norm: 0.643959615464
	Batch 280 , average error: 0.278204387559 , theta norm: 0.644484107002
	Batch 290 , average error: 0.272714546449 , theta norm: 0.648858135823
	Batch 300 , average error: 0.318867338337 , theta norm: 0.650779254265
	Batch 310 , average error: 0.291038588981 , theta norm: 0.650844410096
	Batch 320 , average error: 0.315659996703 , theta norm: 0.654729150796
	Batch 330 , average error: 0.306865550153 , theta norm: 0.659319776897
	Batch 340 , average error: 0.322938110702 , theta norm: 0.663884548902
	Batch 350 , average error: 0.298724264512 , theta norm: 0.669006682905
	Batch 360 , average error: 0.25173588219 , theta norm: 0.67126553593
	Batch 370 , average error: 0.268275146423 , theta norm: 0.672059015545
	Batch 380 , average error: 0.280261861613 , theta norm: 0.674432096278
	Batch 390 , average error: 0.283337030223 , theta norm: 0.678578199322
	Batch 400 , average error: 0.274109960847 , theta norm: 0.678943875193
	Batch 410 , average error: 0.307099559969 , theta norm: 0.680533781975
	Batch 420 , average error: 0.297616903451 , theta norm: 0.683343369164
	Batch 430 , average error: 0.297276743497 , theta norm: 0.681822197613
	Batch 440 , average error: 0.297659743639 , theta norm: 0.684601643856
	Batch 450 , average error: 0.31744261454 , theta norm: 0.685245107102
Epoch 2
evaluating...
	Batch 0 , average error: 0.27913964632 , theta norm: 0.686451249919
	Batch 10 , average error: 0.301646548226 , theta norm: 0.691016930065
	Batch 20 , average error: 0.32685000839 , theta norm: 0.692304081758
	Batch 30 , average error: 0.323769808195 , theta norm: 0.692186772384
	Batch 40 , average error: 0.267512822613 , theta norm: 0.691128210471
	Batch 50 , average error: 0.287888241255 , theta norm: 0.692510968613
	Batch 60 , average error: 0.308504393652 , theta norm: 0.693454746866
	Batch 70 , average error: 0.299768253728 , theta norm: 0.699797540975
	Batch 80 , average error: 0.313313618453 , theta norm: 0.702528350249
	Batch 90 , average error: 0.288054686969 , theta norm: 0.703641882005
	Batch 100 , average error: 0.287283495492 , theta norm: 0.705418429602
	Batch 110 , average error: 0.289754899033 , theta norm: 0.710188079296
	Batch 120 , average error: 0.304691103972 , theta norm: 0.710810765883
	Batch 130 , average error: 0.31029139425 , theta norm: 0.7104876362
	Batch 140 , average error: 0.272813008975 , theta norm: 0.711250107956
	Batch 150 , average error: 0.316869391356 , theta norm: 0.711026877654
	Batch 160 , average error: 0.297212755554 , theta norm: 0.71119966897
	Batch 170 , average error: 0.272811109993 , theta norm: 0.713970080718
	Batch 180 , average error: 0.286071377442 , theta norm: 0.717386304112
	Batch 190 , average error: 0.294448843019 , theta norm: 0.721986452985
	Batch 200 , average error: 0.321544005552 , theta norm: 0.724078588894
	Batch 210 , average error: 0.273095481711 , theta norm: 0.726885622987
	Batch 220 , average error: 0.279014947621 , theta norm: 0.728748597156
	Batch 230 , average error: 0.303412854884 , theta norm: 0.72996799028
	Batch 240 , average error: 0.296862563234 , theta norm: 0.734423364863
	Batch 250 , average error: 0.311927798014 , theta norm: 0.735010602105
	Batch 260 , average error: 0.323789016127 , theta norm: 0.738278366489
	Batch 270 , average error: 0.301146017857 , theta norm: 0.743376505128
	Batch 280 , average error: 0.264613499018 , theta norm: 0.746111908076
	Batch 290 , average error: 0.316124143291 , theta norm: 0.74994224058
	Batch 300 , average error: 0.293680102748 , theta norm: 0.752995972943
	Batch 310 , average error: 0.263577976939 , theta norm: 0.755542643947
	Batch 320 , average error: 0.276705844149 , theta norm: 0.760784771735
	Batch 330 , average error: 0.304165091947 , theta norm: 0.76068603751
	Batch 340 , average error: 0.30111965617 , theta norm: 0.759882709079
	Batch 350 , average error: 0.305815339482 , theta norm: 0.758859652118
	Batch 360 , average error: 0.286263073378 , theta norm: 0.762399585283
	Batch 370 , average error: 0.294303646336 , theta norm: 0.764853367343
	Batch 380 , average error: 0.308804110266 , theta norm: 0.771391428152
	Batch 390 , average error: 0.270216667515 , theta norm: 0.774562365725
	Batch 400 , average error: 0.268438495504 , theta norm: 0.776327977285
	Batch 410 , average error: 0.283637585007 , theta norm: 0.778252718783
	Batch 420 , average error: 0.277837986387 , theta norm: 0.778691775773
	Batch 430 , average error: 0.313522273387 , theta norm: 0.780916231504
	Batch 440 , average error: 0.307089429855 , theta norm: 0.780995806157
	Batch 450 , average error: 0.272963292336 , theta norm: 0.781021853091
Epoch 3
evaluating...
	Batch 0 , average error: 0.298225304042 , theta norm: 0.779060146014
	Batch 10 , average error: 0.256450363261 , theta norm: 0.780098012421
	Batch 20 , average error: 0.286300425258 , theta norm: 0.782263966611
	Batch 30 , average error: 0.285547470006 , theta norm: 0.785102660465
	Batch 40 , average error: 0.313952006532 , theta norm: 0.789144272786
	Batch 50 , average error: 0.328178273533 , theta norm: 0.790304967004
	Batch 60 , average error: 0.29531264564 , theta norm: 0.791508027378
	Batch 70 , average error: 0.293832985943 , theta norm: 0.794820914923
	Batch 80 , average error: 0.300098615063 , theta norm: 0.798961269913
	Batch 90 , average error: 0.282719213729 , theta norm: 0.800285744456
	Batch 100 , average error: 0.251312104905 , theta norm: 0.802344505161
	Batch 110 , average error: 0.311341522262 , theta norm: 0.80549263284
	Batch 120 , average error: 0.292633065213 , theta norm: 0.806175999995
	Batch 130 , average error: 0.312513319969 , theta norm: 0.808512662816
	Batch 140 , average error: 0.280956086401 , theta norm: 0.814557186218
	Batch 150 , average error: 0.291810024215 , theta norm: 0.813514096342
	Batch 160 , average error: 0.285111970852 , theta norm: 0.812821713514
	Batch 170 , average error: 0.29726669389 , theta norm: 0.813405235929
	Batch 180 , average error: 0.306421235086 , theta norm: 0.813944744934
	Batch 190 , average error: 0.309534445614 , theta norm: 0.813651910634
	Batch 200 , average error: 0.295548500808 , theta norm: 0.816212639612
	Batch 210 , average error: 0.306279773989 , theta norm: 0.819401151086
	Batch 220 , average error: 0.309077880101 , theta norm: 0.823395843264
	Batch 230 , average error: 0.310068661452 , theta norm: 0.824942095932
	Batch 240 , average error: 0.313940486934 , theta norm: 0.82548718973
	Batch 250 , average error: 0.302732940833 , theta norm: 0.829854060711
	Batch 260 , average error: 0.290254060409 , theta norm: 0.833230390895
	Batch 270 , average error: 0.319133529413 , theta norm: 0.839533541616
	Batch 280 , average error: 0.281790259506 , theta norm: 0.841790024137
	Batch 290 , average error: 0.284021475928 , theta norm: 0.844524410579
	Batch 300 , average error: 0.308445151633 , theta norm: 0.843433188147
	Batch 310 , average error: 0.283307530689 , theta norm: 0.844338058745
	Batch 320 , average error: 0.282425346543 , theta norm: 0.844522998429
	Batch 330 , average error: 0.294463471561 , theta norm: 0.847179948076
	Batch 340 , average error: 0.254662143907 , theta norm: 0.850002942176
	Batch 350 , average error: 0.268050361114 , theta norm: 0.851500982226
	Batch 360 , average error: 0.271773066435 , theta norm: 0.85121074307
	Batch 370 , average error: 0.294057603097 , theta norm: 0.851477394867
	Batch 380 , average error: 0.272681108606 , theta norm: 0.851182219923
	Batch 390 , average error: 0.27632625065 , theta norm: 0.851277588688
	Batch 400 , average error: 0.277111718504 , theta norm: 0.850893685351
	Batch 410 , average error: 0.293563478718 , theta norm: 0.852427648093
	Batch 420 , average error: 0.299275048757 , theta norm: 0.852538470346
	Batch 430 , average error: 0.286703938832 , theta norm: 0.853182192875
	Batch 440 , average error: 0.327938906733 , theta norm: 0.855073464209
	Batch 450 , average error: 0.296721730149 , theta norm: 0.855015470496
Epoch 4
evaluating...
	Batch 0 , average error: 0.290910419263 , theta norm: 0.855833222815
	Batch 10 , average error: 0.286887311858 , theta norm: 0.855549995627
	Batch 20 , average error: 0.289061020374 , theta norm: 0.855026907013
	Batch 30 , average error: 0.282379856229 , theta norm: 0.856320694321
	Batch 40 , average error: 0.287096122551 , theta norm: 0.856337398005
	Batch 50 , average error: 0.291047007801 , theta norm: 0.85610217002
	Batch 60 , average error: 0.271310906864 , theta norm: 0.855549476387
	Batch 70 , average error: 0.288898528705 , theta norm: 0.855966599747
	Batch 80 , average error: 0.310717706687 , theta norm: 0.858121205825
	Batch 90 , average error: 0.28025059258 , theta norm: 0.859635826631
	Batch 100 , average error: 0.285382792926 , theta norm: 0.860275221332
	Batch 110 , average error: 0.290555228602 , theta norm: 0.859302187593
	Batch 120 , average error: 0.307599224782 , theta norm: 0.859657903846
	Batch 130 , average error: 0.30801498498 , theta norm: 0.860289683634
	Batch 140 , average error: 0.294530331701 , theta norm: 0.861924098018
	Batch 150 , average error: 0.303941026521 , theta norm: 0.861585238241
	Batch 160 , average error: 0.310319000257 , theta norm: 0.862185734664
	Batch 170 , average error: 0.28695219755 , theta norm: 0.861921889186
	Batch 180 , average error: 0.289718089311 , theta norm: 0.861433502532
	Batch 190 , average error: 0.2867538021 , theta norm: 0.859586598888
	Batch 200 , average error: 0.256020322514 , theta norm: 0.862249269752
	Batch 210 , average error: 0.28399545075 , theta norm: 0.862000820351
	Batch 220 , average error: 0.282244948026 , theta norm: 0.86194787469
	Batch 230 , average error: 0.259625938501 , theta norm: 0.861181487363
	Batch 240 , average error: 0.299080329359 , theta norm: 0.860772772403
	Batch 250 , average error: 0.300597744231 , theta norm: 0.861731469423
	Batch 260 , average error: 0.267581980571 , theta norm: 0.863270586575
	Batch 270 , average error: 0.281550420112 , theta norm: 0.865817500308
	Batch 280 , average error: 0.331302202948 , theta norm: 0.866680191383
	Batch 290 , average error: 0.286560675545 , theta norm: 0.867451204376
	Batch 300 , average error: 0.266442094274 , theta norm: 0.869505465231
	Batch 310 , average error: 0.313988961908 , theta norm: 0.869549585908
	Batch 320 , average error: 0.272355343713 , theta norm: 0.871403052952
	Batch 330 , average error: 0.288343866662 , theta norm: 0.873279225726
	Batch 340 , average error: 0.29638696973 , theta norm: 0.875168061182
	Batch 350 , average error: 0.29670168019 , theta norm: 0.87717285436
	Batch 360 , average error: 0.27406354963 , theta norm: 0.8815363425
	Batch 370 , average error: 0.290041940768 , theta norm: 0.884303350981
	Batch 380 , average error: 0.306876853623 , theta norm: 0.883606504195
	Batch 390 , average error: 0.274084361595 , theta norm: 0.884055877107
	Batch 400 , average error: 0.28162518775 , theta norm: 0.883500860061
	Batch 410 , average error: 0.288841906245 , theta norm: 0.883479347722
	Batch 420 , average error: 0.290730350801 , theta norm: 0.882627870676
	Batch 430 , average error: 0.299905693293 , theta norm: 0.882620373616
	Batch 440 , average error: 0.265907670271 , theta norm: 0.883348960352
	Batch 450 , average error: 0.279907364508 , theta norm: 0.882772819973
Computing performance... 6
evaluating...
Initial Performance on validation set: 0.504804171866
Initial Performance on validation set: 0.504804171866
Epoch 0, Performance on validation set: 0.13630017393
Epoch 0, Performance on validation set: 0.13630017393
Epoch 1, Performance on validation set: 0.1378113164
Epoch 1, Performance on validation set: 0.1378113164
Epoch 2, Performance on validation set: 0.138383574095
Epoch 2, Performance on validation set: 0.138383574095
Epoch 3, Performance on validation set: 0.137937646585
Epoch 3, Performance on validation set: 0.137937646585
Epoch 4, Performance on validation set: 0.138133800439
Epoch 4, Performance on validation set: 0.138133800439
End of training.
Writing model to file.
