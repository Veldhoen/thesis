training on data/WSJ for 5 epochs
parameters: batch size = 50, alpha = 0.05, lambda = 0.1.
initializing word embeddings from 
NB Adagrad ON now
Start part of experiment 104
Loading treebank.
/home/sveldhoen/.local/lib/python2.7/site-packages/numpy/core/fromnumeric.py:2507: VisibleDeprecationWarning: `rank` is deprecated; use the `ndim` attribute or function instead. To find the rank of a matrix see `numpy.linalg.matrix_rank`.
  VisibleDeprecationWarning)
Loading vocabulary.
Grammar-based parameter selection on. Initializing 400 most frequent grammar rules.
Initializing networks.
Loaded data. 22923 training examples, and 6010 test examples.
Initializing theta.
inside - 5
nwords - 10689
word - 5
outside - 5
bSize - 50
alpha - 0.05
lambda - 0.1
nEpochs - 5
number of cores - 5
Start training...
Start SGD training
Epoch 0
evaluating...
	Batch 0 , average error: 0.999995282214 , theta norm: 0.270277225435
	Batch 10 , average error: 0.48795307434 , theta norm: 0.487204544246
	Batch 20 , average error: 0.37113812626 , theta norm: 0.596601539314
	Batch 30 , average error: 0.369029786267 , theta norm: 0.656087693631
	Batch 40 , average error: 0.357713072649 , theta norm: 0.686027033164
	Batch 50 , average error: 0.342291725408 , theta norm: 0.725297029992
	Batch 60 , average error: 0.343412364684 , theta norm: 0.750702720152
	Batch 70 , average error: 0.347236120077 , theta norm: 0.777577316292
	Batch 80 , average error: 0.367589041703 , theta norm: 0.799884388563
	Batch 90 , average error: 0.331368065857 , theta norm: 0.822939380986
	Batch 100 , average error: 0.329190302737 , theta norm: 0.837828751532
	Batch 110 , average error: 0.336284368358 , theta norm: 0.85923456449
	Batch 120 , average error: 0.32189510312 , theta norm: 0.877675301721
	Batch 130 , average error: 0.352032461044 , theta norm: 0.893545860922
	Batch 140 , average error: 0.320016423323 , theta norm: 0.904176419217
	Batch 150 , average error: 0.354777012407 , theta norm: 0.913407335708
	Batch 160 , average error: 0.326428179402 , theta norm: 0.929756919843
	Batch 170 , average error: 0.335896983786 , theta norm: 0.94335584105
	Batch 180 , average error: 0.326219704116 , theta norm: 0.954718303641
	Batch 190 , average error: 0.362972130104 , theta norm: 0.965024760293
	Batch 200 , average error: 0.32311297748 , theta norm: 0.972692901183
	Batch 210 , average error: 0.32778873696 , theta norm: 0.980000069139
	Batch 220 , average error: 0.355464798739 , theta norm: 0.993335976766
	Batch 230 , average error: 0.332435209699 , theta norm: 1.00129678531
	Batch 240 , average error: 0.332185535473 , theta norm: 1.00931736552
	Batch 250 , average error: 0.322160814174 , theta norm: 1.01617112367
	Batch 260 , average error: 0.332886348944 , theta norm: 1.02312669561
	Batch 270 , average error: 0.31601374792 , theta norm: 1.02809518008
	Batch 280 , average error: 0.347785105713 , theta norm: 1.03212155977
	Batch 290 , average error: 0.327859588491 , theta norm: 1.03280596058
	Batch 300 , average error: 0.373058515362 , theta norm: 1.03725346093
	Batch 310 , average error: 0.346108321686 , theta norm: 1.04731312769
	Batch 320 , average error: 0.325680949807 , theta norm: 1.05012134134
	Batch 330 , average error: 0.297982125815 , theta norm: 1.05617993366
	Batch 340 , average error: 0.30062379384 , theta norm: 1.06186112311
	Batch 350 , average error: 0.332265532194 , theta norm: 1.06887582176
	Batch 360 , average error: 0.346848409199 , theta norm: 1.07745364245
	Batch 370 , average error: 0.347637639656 , theta norm: 1.08456954536
	Batch 380 , average error: 0.299387971763 , theta norm: 1.08673543961
	Batch 390 , average error: 0.291789255113 , theta norm: 1.08962087656
	Batch 400 , average error: 0.299851210018 , theta norm: 1.09854599764
	Batch 410 , average error: 0.29259086709 , theta norm: 1.10678363379
	Batch 420 , average error: 0.324107132019 , theta norm: 1.11223300879
	Batch 430 , average error: 0.328810279462 , theta norm: 1.11701642012
	Batch 440 , average error: 0.311623310384 , theta norm: 1.1196794938
	Batch 450 , average error: 0.343712704485 , theta norm: 1.12459569171
evaluating...
Epoch 1
	Batch 0 , average error: 0.280054882496 , theta norm: 1.12888552463
	Batch 10 , average error: 0.323245122117 , theta norm: 1.13355912225
	Batch 20 , average error: 0.330951961503 , theta norm: 1.13660921728
	Batch 30 , average error: 0.312640741023 , theta norm: 1.13909386043
	Batch 40 , average error: 0.336849466472 , theta norm: 1.14265382849
	Batch 50 , average error: 0.289280651894 , theta norm: 1.14582710483
	Batch 60 , average error: 0.337375268275 , theta norm: 1.15079698762
	Batch 70 , average error: 0.344633424864 , theta norm: 1.15717411742
	Batch 80 , average error: 0.344960578904 , theta norm: 1.16155271499
	Batch 90 , average error: 0.303625480987 , theta norm: 1.16494058161
	Batch 100 , average error: 0.318314727037 , theta norm: 1.17053081645
	Batch 110 , average error: 0.326201725175 , theta norm: 1.17518579222
	Batch 120 , average error: 0.341518162799 , theta norm: 1.17987247209
	Batch 130 , average error: 0.308469006085 , theta norm: 1.18453470814
	Batch 140 , average error: 0.304765271869 , theta norm: 1.18674967129
	Batch 150 , average error: 0.304296096496 , theta norm: 1.18823507848
	Batch 160 , average error: 0.332525493187 , theta norm: 1.19269000302
	Batch 170 , average error: 0.301179932912 , theta norm: 1.19470242085
	Batch 180 , average error: 0.311543136664 , theta norm: 1.19932404872
	Batch 190 , average error: 0.317228824241 , theta norm: 1.20312741216
	Batch 200 , average error: 0.330231276034 , theta norm: 1.20536264779
	Batch 210 , average error: 0.31259670029 , theta norm: 1.20908702874
	Batch 220 , average error: 0.298312071476 , theta norm: 1.2095251294
	Batch 230 , average error: 0.323508931799 , theta norm: 1.21404867363
	Batch 240 , average error: 0.324300624036 , theta norm: 1.21549196833
	Batch 250 , average error: 0.331602813155 , theta norm: 1.21971898435
	Batch 260 , average error: 0.312446291503 , theta norm: 1.22081087583
	Batch 270 , average error: 0.320596550543 , theta norm: 1.22250972579
	Batch 280 , average error: 0.306197100561 , theta norm: 1.22418633422
	Batch 290 , average error: 0.322429912996 , theta norm: 1.22685363176
	Batch 300 , average error: 0.299098700365 , theta norm: 1.22791899859
	Batch 310 , average error: 0.306330562031 , theta norm: 1.22946117516
	Batch 320 , average error: 0.341463692296 , theta norm: 1.23316174148
	Batch 330 , average error: 0.301755863845 , theta norm: 1.23732851416
	Batch 340 , average error: 0.331711567025 , theta norm: 1.24099363197
	Batch 350 , average error: 0.338240974726 , theta norm: 1.24466899752
	Batch 360 , average error: 0.288660019315 , theta norm: 1.24700973322
	Batch 370 , average error: 0.325149832639 , theta norm: 1.24936066185
	Batch 380 , average error: 0.314862548634 , theta norm: 1.25296260225
	Batch 390 , average error: 0.304663097409 , theta norm: 1.25349874397
	Batch 400 , average error: 0.338216743465 , theta norm: 1.25493544403
	Batch 410 , average error: 0.297632678772 , theta norm: 1.25765473102
	Batch 420 , average error: 0.306883553585 , theta norm: 1.25941699815
	Batch 430 , average error: 0.316204730017 , theta norm: 1.26299265268
	Batch 440 , average error: 0.370215290058 , theta norm: 1.26520065137
	Batch 450 , average error: 0.335433636926 , theta norm: 1.26863462564
Epoch 2
evaluating...
	Batch 0 , average error: 0.315502785006 , theta norm: 1.27085705708
	Batch 10 , average error: 0.292880530005 , theta norm: 1.27255089047
	Batch 20 , average error: 0.325699108492 , theta norm: 1.27573135949
	Batch 30 , average error: 0.322566063263 , theta norm: 1.27663576616
	Batch 40 , average error: 0.309327206899 , theta norm: 1.27956281022
	Batch 50 , average error: 0.35063868787 , theta norm: 1.28170267451
	Batch 60 , average error: 0.316927635385 , theta norm: 1.28506100717
	Batch 70 , average error: 0.342347613173 , theta norm: 1.28610771116
	Batch 80 , average error: 0.289527782955 , theta norm: 1.28748505695
	Batch 90 , average error: 0.264485171837 , theta norm: 1.28911859636
	Batch 100 , average error: 0.341670449777 , theta norm: 1.29172762324
	Batch 110 , average error: 0.31761824437 , theta norm: 1.29384013608
	Batch 120 , average error: 0.316427738918 , theta norm: 1.29815445075
	Batch 130 , average error: 0.310414688923 , theta norm: 1.29994113989
	Batch 140 , average error: 0.319980281988 , theta norm: 1.3030551537
	Batch 150 , average error: 0.317960764708 , theta norm: 1.30490562854
	Batch 160 , average error: 0.309498715081 , theta norm: 1.3072823352
	Batch 170 , average error: 0.338410909601 , theta norm: 1.3085104759
	Batch 180 , average error: 0.287680517533 , theta norm: 1.31081680087
	Batch 190 , average error: 0.339415913583 , theta norm: 1.31233384245
	Batch 200 , average error: 0.333798392733 , theta norm: 1.31435358913
	Batch 210 , average error: 0.306958429489 , theta norm: 1.31577075858
	Batch 220 , average error: 0.309504921654 , theta norm: 1.31735047539
	Batch 230 , average error: 0.305666852577 , theta norm: 1.32148381347
	Batch 240 , average error: 0.368676712337 , theta norm: 1.32416249392
	Batch 250 , average error: 0.329425526146 , theta norm: 1.32714133105
	Batch 260 , average error: 0.339599108815 , theta norm: 1.32921287906
	Batch 270 , average error: 0.315786276375 , theta norm: 1.33001080928
	Batch 280 , average error: 0.314194802262 , theta norm: 1.33212684838
	Batch 290 , average error: 0.293072520337 , theta norm: 1.33393646626
	Batch 300 , average error: 0.304039414075 , theta norm: 1.33717089855
	Batch 310 , average error: 0.298469062788 , theta norm: 1.33925746246
	Batch 320 , average error: 0.297790504585 , theta norm: 1.34124705479
	Batch 330 , average error: 0.316848816974 , theta norm: 1.3426094235
	Batch 340 , average error: 0.30838808586 , theta norm: 1.34425633074
	Batch 350 , average error: 0.358694055649 , theta norm: 1.34754373641
	Batch 360 , average error: 0.343798418594 , theta norm: 1.35142708134
	Batch 370 , average error: 0.317184521751 , theta norm: 1.35285107341
	Batch 380 , average error: 0.31284341429 , theta norm: 1.3555527866
	Batch 390 , average error: 0.305070358088 , theta norm: 1.35952271473
	Batch 400 , average error: 0.306311505974 , theta norm: 1.36200020022
	Batch 410 , average error: 0.327420902886 , theta norm: 1.36259043461
	Batch 420 , average error: 0.336389871837 , theta norm: 1.364320681
	Batch 430 , average error: 0.306290789745 , theta norm: 1.36906548301
	Batch 440 , average error: 0.294037679875 , theta norm: 1.37034978953
	Batch 450 , average error: 0.318292281825 , theta norm: 1.37281001585
Epoch 3
evaluating...
	Batch 0 , average error: 0.332730197068 , theta norm: 1.37289430455
	Batch 10 , average error: 0.326757531816 , theta norm: 1.37346181198
	Batch 20 , average error: 0.311564493227 , theta norm: 1.37678367389
	Batch 30 , average error: 0.310036063462 , theta norm: 1.38006198921
	Batch 40 , average error: 0.321605121604 , theta norm: 1.38146380222
	Batch 50 , average error: 0.294952616228 , theta norm: 1.38226421049
	Batch 60 , average error: 0.286337860893 , theta norm: 1.38378144566
	Batch 70 , average error: 0.320594753274 , theta norm: 1.38540122653
	Batch 80 , average error: 0.326223121544 , theta norm: 1.38737705309
	Batch 90 , average error: 0.329895390995 , theta norm: 1.389299799
	Batch 100 , average error: 0.326339996182 , theta norm: 1.39042295363
	Batch 110 , average error: 0.321497781029 , theta norm: 1.39186871164
	Batch 120 , average error: 0.330693771657 , theta norm: 1.39316737311
	Batch 130 , average error: 0.345375587224 , theta norm: 1.39565500807
	Batch 140 , average error: 0.308382584636 , theta norm: 1.39759759758
	Batch 150 , average error: 0.28959054897 , theta norm: 1.39958819924
	Batch 160 , average error: 0.30544182978 , theta norm: 1.40020401264
	Batch 170 , average error: 0.299179924313 , theta norm: 1.40209767516
	Batch 180 , average error: 0.344127465551 , theta norm: 1.40237888466
	Batch 190 , average error: 0.314391714523 , theta norm: 1.40522152975
	Batch 200 , average error: 0.319453276032 , theta norm: 1.40591984579
	Batch 210 , average error: 0.320291760322 , theta norm: 1.40824517622
	Batch 220 , average error: 0.290717476691 , theta norm: 1.40840105725
	Batch 230 , average error: 0.288820060454 , theta norm: 1.40974454867
	Batch 240 , average error: 0.312867397551 , theta norm: 1.41002162185
	Batch 250 , average error: 0.308454116528 , theta norm: 1.41280091199
	Batch 260 , average error: 0.313645363149 , theta norm: 1.41475112084
	Batch 270 , average error: 0.288385997067 , theta norm: 1.41685830749
	Batch 280 , average error: 0.340537070567 , theta norm: 1.41816831461
	Batch 290 , average error: 0.355907819746 , theta norm: 1.41959316633
	Batch 300 , average error: 0.338644931026 , theta norm: 1.42126434672
	Batch 310 , average error: 0.322348352716 , theta norm: 1.42269190391
	Batch 320 , average error: 0.314765337367 , theta norm: 1.4242805795
	Batch 330 , average error: 0.312927035678 , theta norm: 1.42615398446
	Batch 340 , average error: 0.297420962492 , theta norm: 1.42660665495
	Batch 350 , average error: 0.32052889522 , theta norm: 1.42815635611
	Batch 360 , average error: 0.288488409843 , theta norm: 1.42958096663
	Batch 370 , average error: 0.303497336651 , theta norm: 1.43058480189
	Batch 380 , average error: 0.332233414899 , theta norm: 1.43210416133
	Batch 390 , average error: 0.304772011186 , theta norm: 1.43377234051
	Batch 400 , average error: 0.307530128227 , theta norm: 1.43604870947
	Batch 410 , average error: 0.319269008919 , theta norm: 1.43677227754
	Batch 420 , average error: 0.319948553836 , theta norm: 1.43923214288
	Batch 430 , average error: 0.293153164311 , theta norm: 1.44022544314
	Batch 440 , average error: 0.310528439307 , theta norm: 1.44137321144
	Batch 450 , average error: 0.316326954513 , theta norm: 1.44482676752
Epoch 4
evaluating...
	Batch 0 , average error: 0.330171757402 , theta norm: 1.44535588143
	Batch 10 , average error: 0.304921511901 , theta norm: 1.44715195628
	Batch 20 , average error: 0.322249084278 , theta norm: 1.44742427391
	Batch 30 , average error: 0.309951545751 , theta norm: 1.44940859181
	Batch 40 , average error: 0.313738395492 , theta norm: 1.45030243619
	Batch 50 , average error: 0.295114775638 , theta norm: 1.45231441509
	Batch 60 , average error: 0.308167322875 , theta norm: 1.4529164874
	Batch 70 , average error: 0.297319880313 , theta norm: 1.45420155398
	Batch 80 , average error: 0.325196952162 , theta norm: 1.45570726889
	Batch 90 , average error: 0.337405448076 , theta norm: 1.45894704562
	Batch 100 , average error: 0.295196552169 , theta norm: 1.46065669433
	Batch 110 , average error: 0.318402986545 , theta norm: 1.46163334467
	Batch 120 , average error: 0.318114199804 , theta norm: 1.46332362958
	Batch 130 , average error: 0.337102018608 , theta norm: 1.46493745777
	Batch 140 , average error: 0.292588050671 , theta norm: 1.46531061907
	Batch 150 , average error: 0.285576871354 , theta norm: 1.46631038585
	Batch 160 , average error: 0.284442307041 , theta norm: 1.46756461943
	Batch 170 , average error: 0.299337537235 , theta norm: 1.46926402964
	Batch 180 , average error: 0.294353893783 , theta norm: 1.46906770347
	Batch 190 , average error: 0.322054254133 , theta norm: 1.47090604907
	Batch 200 , average error: 0.283070533166 , theta norm: 1.47221718448
	Batch 210 , average error: 0.325342591917 , theta norm: 1.47206207532
	Batch 220 , average error: 0.318065685433 , theta norm: 1.47258686063
	Batch 230 , average error: 0.310359161234 , theta norm: 1.4734887388
	Batch 240 , average error: 0.292712941473 , theta norm: 1.4744031006
	Batch 250 , average error: 0.297455345689 , theta norm: 1.4751398659
	Batch 260 , average error: 0.30882771376 , theta norm: 1.47614751062
	Batch 270 , average error: 0.286744773586 , theta norm: 1.47713623446
	Batch 280 , average error: 0.287453856813 , theta norm: 1.47865753819
	Batch 290 , average error: 0.299609263589 , theta norm: 1.47900464187
	Batch 300 , average error: 0.317409388941 , theta norm: 1.48162453751
	Batch 310 , average error: 0.301873147373 , theta norm: 1.48195983025
	Batch 320 , average error: 0.319857924468 , theta norm: 1.48366639345
	Batch 330 , average error: 0.329832922693 , theta norm: 1.48481954862
	Batch 340 , average error: 0.330481559624 , theta norm: 1.48453351735
	Batch 350 , average error: 0.323654601008 , theta norm: 1.48499803033
	Batch 360 , average error: 0.286097270995 , theta norm: 1.48595491886
	Batch 370 , average error: 0.315431503876 , theta norm: 1.48712720642
	Batch 380 , average error: 0.324525968937 , theta norm: 1.48932547152
	Batch 390 , average error: 0.303436806872 , theta norm: 1.48973408366
	Batch 400 , average error: 0.284183060181 , theta norm: 1.49104634136
	Batch 410 , average error: 0.291558718433 , theta norm: 1.4911318202
	Batch 420 , average error: 0.304513542934 , theta norm: 1.49229838919
	Batch 430 , average error: 0.338198196482 , theta norm: 1.49334276903
	Batch 440 , average error: 0.322214035782 , theta norm: 1.49400087601
	Batch 450 , average error: 0.307444541684 , theta norm: 1.49426364946
Computing performance... 6
evaluating...
Initial Performance on validation set: 0.495867404815
Initial Performance on validation set: 0.495867404815
Epoch 0, Performance on validation set: 0.145391267447
Epoch 0, Performance on validation set: 0.145391267447
Epoch 1, Performance on validation set: 0.150345352904
Epoch 1, Performance on validation set: 0.150345352904
Epoch 2, Performance on validation set: 0.149867839992
Epoch 2, Performance on validation set: 0.149867839992
Epoch 3, Performance on validation set: 0.15099114331
Epoch 3, Performance on validation set: 0.15099114331
Epoch 4, Performance on validation set: 0.150814228513
Epoch 4, Performance on validation set: 0.150814228513
End of training.
Writing model to file.
